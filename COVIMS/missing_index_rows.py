import os, sys
import pdsparser

PREFIX = '/Volumes/Marks-Migration-HD/holdings/volumes/COVIMS_0xxx/'

MISSING_LABELS = [
    "COVIMS_0004/data/2004163T121836_2004163T192848/v1465673806_2.lbl",
    "COVIMS_0004/data/2004163T193015_2004164T051726/v1465680977_2.lbl",
    "COVIMS_0004/data/2004163T193015_2004164T051726/v1465700253_2.lbl",
    "COVIMS_0004/data/2004164T052125_2004164T083916/v1465711602_2.lbl",
    "COVIMS_0004/data/2004231T031136_2004234T061028/v1471676803_2.lbl",
    "COVIMS_0004/data/2004245T053141_2004248T081652/v1472712701_2.lbl",
    "COVIMS_0004/data/2004245T053141_2004248T081652/v1472969272_4.lbl",
    "COVIMS_0004/data/2004248T084723_2004253T183438/v1473199707_2.lbl",
    "COVIMS_0004/data/2004269T215117_2004272T074311/v1475048593_2.lbl",
    "COVIMS_0005/data/2004289T225942_2004292T210316/v1476574898_2.lbl",
    "COVIMS_0005/data/2004292T210337_2004299T222753/v1476944152_4.lbl",
    "COVIMS_0005/data/2004327T224335_2004338T170407/v1480707723_2.lbl",
    "COVIMS_0006/data/2005019T212432_2005030T082313/v1484867611_2.lbl",
    "COVIMS_0006/data/2005046T014253_2005048T011257/v1487124681_2.lbl",
    "COVIMS_0006/data/2005046T014253_2005048T011257/v1487124708_2.lbl",
    "COVIMS_0006/data/2005046T014253_2005048T011257/v1487124942_2.lbl",
    "COVIMS_0006/data/2005046T014253_2005048T011257/v1487124969_2.lbl",
    "COVIMS_0006/data/2005067T113241_2005068T054421/v1489039632_2.lbl",
    "COVIMS_0006/data/2005068T055549_2005072T012910/v1489040393_2.lbl",
    "COVIMS_0006/data/2005068T055549_2005072T012910/v1489040893_2.lbl",
    "COVIMS_0006/data/2005068T055549_2005072T012910/v1489041542_2.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523286537_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523286831_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523287125_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523287419_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523287713_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523288007_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523288301_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523288595_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523288889_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523289183_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523289477_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523289771_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523290064_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523290358_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523290652_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523290946_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523291440_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523291734_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523292028_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523292322_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523292616_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523292910_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523293204_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523293498_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523293792_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523294086_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523294380_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523294674_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523294967_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523295261_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523295555_8.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523295849_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523344347_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523344984_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523345620_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523346256_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523346892_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523347528_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523348164_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523349267_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523349904_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523350540_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523351176_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523351812_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523352448_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523353084_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523374139_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523374347_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523374555_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523374763_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523374970_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523375178_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523375386_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523375593_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523375801_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523376009_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523376234_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523376650_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523377065_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523377480_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523377895_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523378310_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523378726_1.lbl",
    "COVIMS_0012/data/2006099T144331_2006100T162855/v1523379141_1.lbl",
    "COVIMS_0012/data/2006100T163551_2006106T084326/v1523379556_1.lbl",
    "COVIMS_0012/data/2006100T163551_2006106T084326/v1523379971_1.lbl",
    "COVIMS_0012/data/2006100T163551_2006106T084326/v1523380418_1.lbl",
    "COVIMS_0012/data/2006100T163551_2006106T084326/v1523381067_1.lbl",
    "COVIMS_0012/data/2006100T163551_2006106T084326/v1523381716_1.lbl",
    "COVIMS_0012/data/2006100T163551_2006106T084326/v1523382977_1.lbl",
]

for path in MISSING_LABELS:
    label = pdsparser.PdsLabel.from_file(PREFIX + path)
    label = label.as_dict()

    file_name = path[47:]
    sclk = file_name[1:11]

    day = julian.day_from_string(label['START_TIME'][:8])
    start_ymd = julian.ymd_format_from_day(day)
    day = julian.day_from_string(label['STOP_TIME'][:8])
    stop_ymd = julian.ymd_format_from_day(day)

    rec = ','.join([
        'urn:nasa:pds:cassini_vims_saturn:data_raw:%s    ' % sclk,
        '%sxxxxx/%s.qub       ' % (sclk[:5], sclk),
        '"%s        "' % file_name.replace('.lbl','.qub'),
        '"%s"' % path[11:46],
        '"%-4s"' % label['SEQUENCE_ID'],
        '%s%s' % (start_ymd,label['START_TIME'][8:]),
        '%s%s' % (stop_ymd,label['STOP_TIME'][8:]),
        '"%-20s"' % label['SPACECRAFT_CLOCK_START_COUNT'][2:],
        '"%-20s"' % label['SPACECRAFT_CLOCK_STOP_COUNT'][2:],
        '"%-30s"' % label['TARGET_NAME'],
        '"%-20s"' % label['INSTRUMENT_MODE_ID'],
        '"%-30s"' % label['OBSERVATION_ID'],
        '"%-3s"' % label['SPECTRAL_EDITING_FLAG'],
        '"%-3s"' % label['SPECTRAL_SUMMING_FLAG'],
        '"OFF"',                          # STAR_TRACKING always OFF
        '%2d' % label['SWATH_WIDTH'],
        '%2d' % label['SWATH_LENGTH'],
        '%10.3f' % label['EXPOSURE_DURATION'][0],
        '"%-8s"' % label['SAMPLING_MODE_ID'][0],
        '%10.3f' % label['EXPOSURE_DURATION'][1],
        '"%-8s"' % label['SAMPLING_MODE_ID'][1],
        '"1/%-20s"' % file_name[1:-4],
        '"%s"' % path[:11],
        '%11s' % '+1.E32',                      # CENTER_LATITUDE
        '%11s' % '+1.E32',                      # CENTER_LONGITUDE
        '%14s' % '+1.E32',                      # CENTRAL_BODY_DISTANCE
        '"EQUATORIAL INERTIAL CART COORD  "',   # COORDINATE_SYSTEM_NAME
        '%11s' % '+1.E32',                      # DECLINATION
        '%11s' % '+1.E32',                      # EMISSION_ANGLE
        '%11s' % '+1.E32',                      # INCIDENCE_ANGLE
        '%11s' % '+1.E32',                      # LOWER_LEFT_LATITUDE
        '%11s' % '+1.E32',                      # LOWER_LEFT_LONGITUDE
        '%11s' % '+1.E32',                      # LOWER_RIGHT_LATITUDE
        '%11s' % '+1.E32',                      # LOWER_RIGHT_LONGITUDE
        '%14s' % '+1.E32',                      # MAXIMUM_RING_RADIUS
        '%14s' % '+1.E32',                      # MINIMUM_RING_RADIUS
        '%11s' % '+1.E32',                      # NORTH_AZIMUTH_CLOCK_ANGLE
        '%11s' % '+1.E32',                      # PHASE_ANGLE
        '%11s' % '+1.E32',                      # PIXEL_SCALE
        '%11s' % '+1.E32',                      # PLANET_CENTER
        '%11s' % '+1.E32',
        '%11s' % '+1.E32',                      # RIGHT_ASCENSION
        '%11s' % '+1.E32',                      # RING_EMISSION_ANGLE
        '%11s' % '+1.E32',                      # RING_INCIDENCE_ANGLE
        '%14s' % '+1.E32',                      # SC_PLANET_POSITION_VECTOR
        '%14s' % '+1.E32',
        '%14s' % '+1.E32',
        '%14s' % '+1.E32',                      # SC_PLANET_VELOCITY_VECTOR
        '%14s' % '+1.E32',
        '%14s' % '+1.E32',
        '%14s' % '+1.E32',                      # SC_SUN_POSITION_VECTOR
        '%14s' % '+1.E32',
        '%14s' % '+1.E32',
        '%14s' % '+1.E32',                      # SC_SUN_VELOCITY_VECTOR
        '%14s' % '+1.E32',
        '%14s' % '+1.E32',
        '%14s' % '+1.E32',                      # SC_TARGET_POSITION_VECTOR
        '%14s' % '+1.E32',
        '%14s' % '+1.E32',
        '%14s' % '+1.E32',                      # SC_TARGET_VELOCITY_VECTOR
        '%14s' % '+1.E32',
        '%14s' % '+1.E32',
        '%11s' % '+1.E32',                      # SUB_SOLAR_LATITUDE
        '%11s' % '+1.E32',                      # SUB_SOLAR_LONGITUDE
        '%11s' % '+1.E32',                      # SUB_SPACECRAFT_LATITUDE
        '%11s' % '+1.E32',                      # SUB_SPACECRAFT_LONGITUDE
        '%14s' % '+1.E32',                      # TARGET_DISTANCE
        '%11s' % '+1.E32',                      # TARGET_EASTERNMOST_LONGITUDE
        '%11s' % '+1.E32',                      # TARGET_NORTHERNMOST_LATITUDE
        '%11s' % '+1.E32',                      # TARGET_SOUTHERNMOST_LATITUDE
        '%11s' % '+1.E32',                      # TARGET_WESTERNMOST_LONGITUDE
        '%11s' % '+1.E32',                      # TWIST_ANGLE
        '%11s' % '+1.E32',                      # UPPER_LEFT_LATITUDE
        '%11s' % '+1.E32',                      # UPPER_LEFT_LONGITUDE
        '%11s' % '+1.E32',                      # UPPER_RIGHT_LATITUDE
        '%11s' % '+1.E32',                      # UPPER_RIGHT_LONGITUDE
    ])

    print rec

